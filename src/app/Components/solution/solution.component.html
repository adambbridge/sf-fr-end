<h3 class="text-h1">{{ solution.name }}</h3>

<!-- SPACES -->

<mat-tab-group>
    <mat-tab label="Workspaces">
        <!-- tab content in ng-templates are lazy loaded -->
        <ng-template matTabContent>
            <!-- TODO replace with reusable spaces template 
            pass it the solution via @Input
            also use it to show spaces under an org
            in podio assets component. -->

            <mat-accordion>
                <mat-expansion-panel *ngFor="let space of solution.workspaces" (opened)="panelOpenState = true"
                    (closed)="panelOpenState = false">
                    <mat-expansion-panel-header>
                        <mat-panel-title>{{ space.workspaceName }}</mat-panel-title>
                        <mat-panel-description>
                            Applications: {{ space.podioSpace.applications.length }}
                        </mat-panel-description>
                    </mat-expansion-panel-header>

                    <mat-list dense>
                        <mat-list-item>ID: {{ space.workspaceId }}</mat-list-item>
                        <mat-list-item>Owner: {{ space.podioSpace.owner }}</mat-list-item>
                        <mat-list-item>
                            Created: {{ space.podioSpace.created_on }}
                        </mat-list-item>
                        <mat-list-item>
                            <h4 mat-line>Description:</h4>
                            <p mat-line>{{ space.description }}</p>
                        </mat-list-item>
                        <mat-list-item>
                            <h4 mat-line>Applications:</h4>
                            <p mat-line>
                                <span *ngFor="let app of space.podioSpace.applications" class="pr-2">
                                    {{ app }}
                                </span>
                            </p>
                        </mat-list-item>
                    </mat-list>
                </mat-expansion-panel>
            </mat-accordion>
        </ng-template>
    </mat-tab>

    <!-- HISTORY AND TASKS 
        current solution model does not include history
        can we fetch this data? 
        is this a nice to have?
        for now i will add it to fake data -->

    <mat-tab label="History and Tasks">
        <!-- tab content in ng-templates are lazy loaded -->
        <ng-template matTabContent>
            <!-- TODO SEPARATE HISTORY COMPONENT -->

            <div class='mt-2'>

                <div class="d-flex justify-content-between align-items-center">
                    <!-- FILTER -->
                    <mat-form-field>
                        <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Search history...">
                    </mat-form-field>

                    <!-- TASKS -->
                    <span class="button-row">
                        <button mat-raised-button class='mr-2' (click)='onUpdateClick()'>New Update</button>

                        <button mat-raised-button class='mr-2' (click)='onDeploymentClick()'>New Deployment</button>

                        <button mat-raised-button class='mr-2' (click)='onPatchClick()'>New Patch</button>
                    </span>
                </div>

                <div class="table-container mat-elevation-z4">
                    <table mat-table [dataSource]="dataSource" matSort multiTemplateDataRows>
                        <!-- CELL DEFINITIONS GROUPED BY COLUMN -->

                        <!-- NAME COLUMN -->
                        <!-- coldef=name, 
            sort directive
            headerr-cell styling
            el obj property corresponding to column -->
                        <ng-container matColumnDef="date">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                                Date
                            </th>
                            <td mat-cell *matCellDef="let element">
                                {{ element.date }}
                            </td>
                            <td mat-footer-cell *matFooterCellDef></td>
                        </ng-container>

                        <!-- VERSION COLUMN -->
                        <ng-container matColumnDef="task">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                                Task
                            </th>
                            <td mat-cell *matCellDef="let element">
                                {{ element.task }}
                            </td>
                            <td mat-footer-cell *matFooterCellDef></td>
                        </ng-container>

                        <!-- SPACES COLUMN -->
                        <ng-container matColumnDef="environment">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                                Environment
                            </th>
                            <td mat-cell *matCellDef="let element">
                                {{ element.environment }}
                            </td>
                            <td mat-footer-cell *matFooterCellDef></td>
                        </ng-container>

                        <!-- CREATED COLUMN -->
                        <ng-container matColumnDef="description">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                                Description
                            </th>
                            <!-- show description medium and up else show icon -->
                            <td mat-cell *matCellDef="let element">
                                <span class='hidden-sm-down'>{{ element.description }}</span>
                                <span class="hidden-md-up">
                                    <mat-icon aria-hidden="false" aria-label="Example home icon">more_vert</mat-icon>
                                </span>
                            </td>
                            <td mat-footer-cell *matFooterCellDef></td>
                        </ng-container>

                        <!-- ROW DEFINITIONS -->
                        <tbody>
                            <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"
                                class="md-elevation-z5"></tr>
                            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
                            <tr mat-footer-row *matFooterRowDef="displayedColumns; sticky: true"></tr>

                            <tr mat-footer-row *matFooterRowDef="displayedColumns; sticky: true"></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- END PASTE FROM SOLUTIONS -->
        </ng-template>
    </mat-tab>
</mat-tab-group>